DROP SCHEMA IF EXISTS `mecanica_lamborghini`; 

CREATE SCHEMA `mecanica_lamborghini`;

USE `mecanica_lamborghini`;

CREATE TABLE Usuario 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,   
 TipoUser ENUM('User', 'Mec'),  
 Nome VARCHAR(255),  
 CPF VARCHAR(11) NOT NULL,  
 Celular VARCHAR(11),  
 email VARCHAR(255),  
 Login VARCHAR(255),  
 Senha VARCHAR(50), 
 unique (login)
); 

CREATE TABLE Orcamento 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,    
 TotalPeca FLOAT,  
 TotalServico FLOAT,  
 ValorTotal FLOAT,  
 Descricao VARCHAR(1000),  
 Status VARCHAR(50),  
 id_Carro INT,  
 id_Usuario INT  
); 

CREATE TABLE Carro 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,   
 Modelo VARCHAR(50),  
 Cor VARCHAR(50),  
 Placa VARCHAR(7),  
 Ano INT(4),  
 Marca VARCHAR(50),  
 id_Usuario INT  
); 

CREATE TABLE Servico 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,  
 Nome VARCHAR(50),  
 ValorAtual FLOAT,  
 UnMedida VARCHAR(20) 
); 

CREATE TABLE ItemServico 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,    
 Qnt INT(2),  
 ValorUn FLOAT,  
 ValorTotal FLOAT,  
 id_Servico INT,  
 id_Orcamento INT  
); 

CREATE TABLE ItemPeca 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,   
 Qnt INT(3),  
 ValorUn FLOAT,  
 ValorTotal FLOAT,  
 id_Orcamento INT,  
 id_Peca INT  
); 

CREATE TABLE Peca 
( 
 id INT PRIMARY KEY AUTO_INCREMENT,    
 Nome VARCHAR(50),  
 ValorAtual FLOAT,  
 UnMedida VARCHAR(20)  
);

ALTER TABLE Orcamento ADD FOREIGN KEY(id_Carro) REFERENCES Carro (id);
ALTER TABLE Orcamento ADD FOREIGN KEY(id_Usuario) REFERENCES Usuario (id);
ALTER TABLE Carro ADD FOREIGN KEY(id_Usuario) REFERENCES Usuario (id);
ALTER TABLE ItemServico ADD FOREIGN KEY(id_Servico) REFERENCES Servico (id);
ALTER TABLE ItemServico ADD FOREIGN KEY(id_Orcamento) REFERENCES Orcamento (id);
ALTER TABLE ItemPeca ADD FOREIGN KEY(id_Orcamento) REFERENCES Orcamento (id);
ALTER TABLE ItemPeca ADD FOREIGN KEY(id_Peca) REFERENCES Peca (id);
